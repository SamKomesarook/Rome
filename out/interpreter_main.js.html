<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: interpreter/main.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: interpreter/main.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import RVisitor from "./RomeVisitor";
// import ErrorReporter from "./ErrorReporter";
var antlr4 = require("antlr4");
var RomeLexer = require("../lang/RomeLexer").RomeLexer;
var RomeParser = require("../lang/RomeParser").RomeParser;

/**
 * main Interpreter class
 */
class Interpreter {
  constructor(
    code,
    memArr,
    updateContentType,
    moveMem,
    writeContent,
    freeMem,
    sendMemAnimation,
    readMemAnimation,
    toggle,
    printAnimation
  ) {
    this.code = code;
    this.memArr = memArr;
    this.updateContentType = updateContentType;
    this.moveMem = moveMem;
    this.writeContent = writeContent;
    this.freeMem = freeMem;
    this.sendMemAnimation = sendMemAnimation;
    this.readMemAnimation = readMemAnimation;
    this.toggle = toggle;
    this.printAnimation = printAnimation;
    this.start(code);
  }

  /**
   * Starting point of lexer, parser and interpreter. Interpreter will only comes in when there is no error in code
   * @param {Object} code code that need to be parsed
   */
  start(code) {
    var chars = new antlr4.InputStream(code);
    var lexer = new RomeLexer(chars);
    // lexer.removeErrorListeners();
    // lexer.addErrorListener(new ErrorReporter(this));
    var tokens = new antlr4.CommonTokenStream(lexer);
    var parser = new RomeParser(tokens);
    parser.buildParseTrees = true;
    // replace with custom error listener
    // parser.removeErrorListeners();
    // parser.addErrorListener(new ErrorReporter(this));
    const tree = parser.r();
    // run code when there is no exception
    if (tree.exception === null &amp;&amp; parser._syntaxErrors === 0) {
      try {
        tree.accept(
          new RVisitor(
            this.memArr,
            this.updateContentType,
            this.moveMem,
            this.writeContent,
            this.freeMem,
            this.sendMemAnimation,
            this.readMemAnimation,
            this.printAnimation
          )
        );
        this.toggle();
      } catch (e) {
        console.log("ERROR AFTER");
        alert(e.name + ": " + e.message);
      }
    } else {
      console.log("ERROR BEFORE");
    }
  }
}

export default Interpreter;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="ErrorReporter.html">ErrorReporter</a></li><li><a href="Interpreter.html">Interpreter</a></li><li><a href="MemoryBlock.html">MemoryBlock</a></li><li><a href="RVisitor.html">RVisitor</a></li><li><a href="Utility.html">Utility</a></li></ul><h3>Global</h3><ul><li><a href="global.html#constructMem">constructMem</a></li><li><a href="global.html#mapMemObjToSymbol">mapMemObjToSymbol</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Thu Oct 10 2019 15:03:18 GMT+1100 (Australian Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
